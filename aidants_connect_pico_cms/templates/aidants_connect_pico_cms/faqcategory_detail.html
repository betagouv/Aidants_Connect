{% extends 'layouts/main.html' %}
{% load ac_common dsfr_tags static %}

{% block title %}
  FAQ {{ object.name }} - Aidants Connect
{% endblock title %}

{% block nav %}
    {% include 'public_website/layout/_header.html' %}
{% endblock nav %}

{% block content %}
  <div class="fr-container">
    <section>
      <h1>Aide</h1>
    </section>
    <p class="subtitle">Vous trouverez ici les réponses aux questions les plus fréquemment posées à nos équipes.</p>

    <div class="fr-grid-row">
      <div class="fr-col-12 fr-col-md-4">
        <nav class="fr-sidemenu fr-sidemenu--sticky" aria-labelledby="fr-sidemenu-title">
          <div class="fr-sidemenu__inner">
            <button
              class="fr-sidemenu__btn"
              aria-controls="fr-sidemenu-wrapper"
              aria-expanded="false"
            >
              Menu
            </button>
            <div class="fr-collapse" id="fr-sidemenu-wrapper">
              <ul class="fr-sidemenu__list">
                {% for category in categories %}
                  <li class="fr-sidemenu__item">
                    <a
                      href="{% if category.slug == object.slug %}#{% else %}{{ category.get_absolute_url }}{% endif %}"
                      class="fr-sidemenu__link"
                      target="_self"
                      {% if category.slug == object.slug %}aria-current="page"{% endif %}
                    >
                      {{ category.name }}
                    </a>
                  </li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </nav>
      </div>

      {# Questions #}
      <div class="fr-col-12 fr-col-md-8">
        <h2 class="fr-h3">{{ object.name }}</h2>
        {% if object.body %}
          <section>{{ object.to_html }}</section>
        {% endif %}

        {% for question in questions %}
          {% ifchanged question.subcategory %}
            {% if question.subcategory %}
              <h3 class="fr-h4">{{ question.subcategory.name }}</h3>
              {% if question.subcategory.body %}
                <section class="fr-mb-8v">{{ question.subcategory.to_html }}</section>
              {% endif %}
            {% endif %}
          {% endifchanged %}

          {% ifchanged question.subcategory %}<div class="fr-accordions-group">{% endifchanged %}
            {% withdict key="accordion-{{ question.pk }}" title=question.question content=question.to_html as data_dict %}
              {% dsfr_accordion data_dict %}
            {% endwithdict %}
          {% ifchanged question.subcategory %}</div>{% endifchanged %}
        {% endfor %}
      </div>
      {# /Questions #}
    </div>
  </div>
{% endblock content %}
