{% extends 'layouts/main-habilitation.html' %}
{% load static ac_common form_extras %}

{% block extracss %}
  <link href="{% static 'css/login.css' %}" rel="stylesheet">
{% endblock extracss %}

{% block title %}
  Connectez-vous{% if form.errors|length > 0 %} (Erreur dans le formulaire){% endif %} - Aidants Connect
{% endblock %}

{% block content %}
  <div class="fr-container">

    <div class="fr-grid-row">
      <div class="fr-col-12 fr-col-md-8">
        <h1>Connectez-vous</h1>
        <p class="subtitle">
          Vous êtes un ou une aidante professionnelle et vous faites partie d’une structure habilitée
          Aidants Connect ? Retrouvez votre espace en vous connectant ci-dessous.
        </p>

        <section class="shadowed blue habilitation-notice">
          <span class="strong">Vous êtes une structure qui souhaite utiliser Aidants Connect ?</span><br/>
          Nous vous invitons à remplir <a href="{% url 'habilitation' %}">notre formulaire d’habilitation</a>
        </section>
        {% if user.is_authenticated %}
          <div class="notification" role="alert">
            Vous êtes déjà connecté.
          </div>
          <div class="text-center">
            <a href="{% url 'LOGGED_IN_REDIRECT_URL_NAME' %}" class="btn btn-success">Accédez à l’accueil</a>
            <a href="{% url 'LOGOUT_URL_NAME' %}" class="btn btn-warning">Déconnectez-vous</a>
          </div>
        {% else %}
          {% for message in messages %}
            <div class="notification {% if message.tags %}{{ message.tags }}{% endif %}" role="alert">
              {{ message }}
            </div>
          {% endfor %}

          <form method="post" class="shadowed login-form">
            {% csrf_token %}
            {{ form.errors }}
            {% field_as_fr_grid_row form.email label_size="medium" %}
            {% field_as_fr_grid_row OTP_form.otp_token label_size="medium" %}

            <div class="button-box">
              <input type="submit" class="button primary" value="Se connecter"/>
            </div>
          </form>
        {% endif %}
        <div class="shadowed red margin-bottom-2rem margin-top-2rem padding-0-5rem">
          Si la connexion ne fonctionne pas, <b>merci d’essayer au moins 4 fois</b> avant de contacter l’équipe support
          à l’adresse {% mailto "contact@aidantsconnect.beta.gouv.fr" %} en précisant votre nom, structure, et la
          nature du problème.
        </div>
      </div>
    </div>
  </div>
{% endblock content %}
